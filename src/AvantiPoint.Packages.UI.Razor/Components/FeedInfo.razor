@inject NavigationManager Navigation

<div class="feed-info-card">
    <h3>üì¶ Feed Connection</h3>
    
    <div class="info-section">
        <label>NuGet Feed URL:</label>
        <div class="url-display">
            <code>@GetFeedUrl()</code>
            <button class="copy-btn" @onclick="CopyFeedUrl" title="Copy to clipboard">
                üìã
            </button>
        </div>
    </div>

    <div class="info-section">
        <h4>Add to NuGet Sources</h4>
        <div class="command-box">
            <strong>.NET CLI:</strong>
            <code>dotnet nuget add source @GetFeedUrl() --name "@FeedName"</code>
        </div>
        <div class="command-box">
            <strong>NuGet CLI:</strong>
            <code>nuget sources add -Name "@FeedName" -Source @GetFeedUrl()</code>
        </div>
    </div>

    <div class="info-section">
        <h4>Use in NuGet.Config</h4>
        <pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;configuration&gt;
  &lt;packageSources&gt;
    &lt;add key="@FeedName" value="@GetFeedUrl()" /&gt;
  &lt;/packageSources&gt;
&lt;/configuration&gt;</code></pre>
    </div>

    @if (ShowAuthenticationInfo)
    {
        <div class="info-section auth-info">
            <h4>üîê Authentication Required</h4>
            <p>This feed requires authentication. Configure credentials using:</p>
            <div class="command-box">
                <code>dotnet nuget add source @GetFeedUrl() --name "@FeedName" --username YOUR_USERNAME --password YOUR_TOKEN --store-password-in-clear-text</code>
            </div>
        </div>
    }
</div>

<style>
    .feed-info-card {
        background-color: white;
        border: 1px solid #d0d7de;
        border-radius: 6px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .feed-info-card h3 {
        font-size: 1.25rem;
        margin-bottom: 1.25rem;
        color: #24292f;
    }

    .feed-info-card h4 {
        font-size: 1rem;
        margin-bottom: 0.75rem;
        color: #24292f;
    }

    .info-section {
        margin-bottom: 1.5rem;
    }

    .info-section:last-child {
        margin-bottom: 0;
    }

    .info-section label {
        display: block;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: #57606a;
    }

    .url-display {
        display: flex;
        gap: 0.5rem;
        align-items: center;
    }

    .url-display code {
        flex: 1;
        display: block;
        background-color: #f6f8fa;
        padding: 0.75rem;
        border-radius: 4px;
        font-family: 'Consolas', 'Monaco', monospace;
        font-size: 0.875rem;
        border: 1px solid #d0d7de;
        word-break: break-all;
    }

    .copy-btn {
        background-color: #f6f8fa;
        border: 1px solid #d0d7de;
        border-radius: 4px;
        padding: 0.5rem 0.75rem;
        cursor: pointer;
        font-size: 1rem;
        transition: all 0.2s;
    }

    .copy-btn:hover {
        background-color: #eaeef2;
        border-color: #8c959f;
    }

    .command-box {
        margin-bottom: 0.75rem;
    }

    .command-box:last-child {
        margin-bottom: 0;
    }

    .command-box strong {
        display: block;
        margin-bottom: 0.25rem;
        color: #57606a;
        font-size: 0.875rem;
    }

    .command-box code {
        display: block;
        background-color: #24292f;
        color: #c9d1d9;
        padding: 0.75rem;
        border-radius: 4px;
        font-family: 'Consolas', 'Monaco', monospace;
        font-size: 0.875rem;
        overflow-x: auto;
        white-space: pre-wrap;
        word-break: break-all;
    }

    pre {
        margin: 0;
    }

    pre code {
        display: block;
        background-color: #24292f;
        color: #c9d1d9;
        padding: 0.75rem;
        border-radius: 4px;
        font-family: 'Consolas', 'Monaco', monospace;
        font-size: 0.875rem;
        overflow-x: auto;
    }

    .auth-info {
        background-color: #fff8c5;
        padding: 1rem;
        border-radius: 4px;
        border: 1px solid #d4a72c;
    }

    .auth-info h4 {
        margin-top: 0;
    }

    .auth-info p {
        margin-bottom: 0.75rem;
        color: #57606a;
    }
</style>

@code {
    /// <summary>
    /// The display name for the feed (used in configuration examples).
    /// </summary>
    [Parameter]
    public string FeedName { get; set; } = "MyNuGetFeed";

    /// <summary>
    /// Whether to show authentication information.
    /// </summary>
    [Parameter]
    public bool ShowAuthenticationInfo { get; set; } = false;

    private string GetFeedUrl()
    {
        var uri = new Uri(Navigation.Uri);
        return $"{uri.Scheme}://{uri.Authority}/v3/index.json";
    }

    private async Task CopyFeedUrl()
    {
        var url = GetFeedUrl();
        // Note: Clipboard API requires HTTPS or localhost
        // await JSRuntime.InvokeVoidAsync("navigator.clipboard.writeText", url);
        // For now, user can manually copy
    }
}
